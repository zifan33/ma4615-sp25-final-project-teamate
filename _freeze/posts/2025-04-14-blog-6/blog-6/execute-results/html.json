{
  "hash": "41a2d023367ad1abd62182a83b3800fb",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Blog 6: Wrapping Up the Analysis\"\ndescription:  |\n  Wrapping up original analysis in the paper.\nauthor: \"TEAMATE\"\ndate: \"2025-04-016\"\ndraft: FALSE\n---\n\n\n\nThis post replicates the table 1 and 2 in the paper in R.\n\nNote: Experiment data is from 2019-2021, while census data is from 2019-2024. The following code aggregate application level data to the **state** level and merge it with the census data to calculate the proportion of applications by state.\n\nThis exercise will help us understand the background of the data on a state-by-state basis and explore the relationship between callback rates and other variables at the state level.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrm(list = ls())\n# hide warnings\noptions(warn = -1)\nsuppressPackageStartupMessages(library(ggplot2))\nsuppressPackageStartupMessages(library(tidyverse))\nsuppressPackageStartupMessages(library(dplyr))\nsuppressPackageStartupMessages(library(stargazer))\nsuppressPackageStartupMessages(library(readxl))\nsuppressPackageStartupMessages(library(fixest))\nsuppressPackageStartupMessages(library(usmap))\nsuppressPackageStartupMessages(library(lfe))    \nsuppressPackageStartupMessages(library(lmtest))\nsuppressPackageStartupMessages(library(sandwich)) \nsuppressPackageStartupMessages(library(multiwayvcov))\n\n\ndata <- readRDS(\"dataset/cleaned_data.rds\")\n```\n:::\n\n\n\n## Data Background and Context\n\nThe dataset originates from the landmark study *\"Systemic Discrimination Among Large U.S. Employers\"* (Kline, Rose, and Walters, 2022).\n\n-   **Research Questions:** The study explores whether discrimination is endemic to particular firms, investigates firm-level heterogeneity in callback rates, and considers the potential impact of industry, geographic location, and other structural factors.\n\nThe census data was retrieved from the United States Census Bureau at this link: https://www.census.gov/data/tables/time-series/demo/popest/2020s-state-total.html\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfor(k in 1:4) {\n  data[[paste0(\"region4_\", k)]] <- as.integer(data$region4 == k)\n}\n\nfor(k in 1:5) {\n  data[[paste0(\"wave\", k)]] <- as.integer(data$wave == k)\n}\n```\n:::\n\n\n\n# Table 1: Summary Statistics\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvars <- c(\"female\", \"over40\", \"lgbtq_club\", \"academic_club\", \"political_club\",\n          \"gender_neutral_pronouns\", \"same_gender_pronouns\", \"associates\",\n          \"region4_1\", \"region4_2\", \"region4_3\", \"region4_4\",\n          \"wave1\", \"wave2\", \"wave3\", \"wave4\", \"wave5\",\n          \"cb\", \"call_cb\", \"email_cb\", \"text_cb\", \"any_cb_0_14\", \"any_cb_15_30\")\n\ndata <- data %>%\n  mutate(balanced_group = if_else(balanced >= 1, \"Balanced\", \"All Firms\"),\n         race = if_else(black == 1, \"Black\", \"White\"))\n\nsummary_table <- data %>%\n  filter(balanced >= 0) %>%   \n  group_by(balanced_group, race) %>%\n  summarise(across(all_of(vars),\n                   list(mean = ~mean(. , na.rm = TRUE),\n                        sd = ~sd(., na.rm = TRUE),\n                        n  = ~sum(!is.na(.))),\n                   .names = \"{col}_{fn}\"),\n            .groups = \"drop\")\n\nsummary_table\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 71\n  balanced_group race  female_mean female_sd female_n over40_mean over40_sd\n  <chr>          <chr>       <dbl>     <dbl>    <int>       <dbl>     <dbl>\n1 All Firms      Black       0.506     0.500     9141       0.541     0.498\n2 All Firms      White       0.492     0.500     9134       0.538     0.499\n3 Balanced       Black       0.498     0.500    32665       0.533     0.499\n4 Balanced       White       0.500     0.500    32703       0.534     0.499\n# ℹ 64 more variables: over40_n <int>, lgbtq_club_mean <dbl>,\n#   lgbtq_club_sd <dbl>, lgbtq_club_n <int>, academic_club_mean <dbl>,\n#   academic_club_sd <dbl>, academic_club_n <int>, political_club_mean <dbl>,\n#   political_club_sd <dbl>, political_club_n <int>,\n#   gender_neutral_pronouns_mean <dbl>, gender_neutral_pronouns_sd <dbl>,\n#   gender_neutral_pronouns_n <int>, same_gender_pronouns_mean <dbl>,\n#   same_gender_pronouns_sd <dbl>, same_gender_pronouns_n <int>, …\n```\n\n\n:::\n:::\n\n\n\n# Table 2: Effect of Resume Characteristics on Contact Rates\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_all <- data %>% filter(balanced >= 0) %>%\n  mutate(wave = factor(wave),\n         region4 = factor(region4))\ndata_bal <- data %>% filter(balanced >= 1) %>%\n  mutate(wave = factor(wave),\n         region4 = factor(region4))\n\n\nreg_formula <- as.formula(\"cb ~ black + female + over40 + political_club + academic_club + \n                           lgbtq_club + same_gender_pronouns + gender_neutral_pronouns + \n                           associates + wave + region4\")\n\n# Linear Probability Model (LPM)\nfit_lpm_all <- lm(reg_formula, data = data_all)\n# Clustered standard errors by job_id\ncl_vcov_all <- cluster.vcov(fit_lpm_all, data_all$job_id)\nlpm_all_coefs <- coeftest(fit_lpm_all, vcov = cl_vcov_all)\n\n# Logit Model for all firms\nfit_logit_all <- glm(reg_formula, data = data_all, family = binomial(link = \"logit\"))\ncl_vcov_logit_all <- cluster.vcov(fit_logit_all, data_all$job_id)\nlogit_all_coefs <- coeftest(fit_logit_all, vcov = cl_vcov_logit_all)\n\n#print(lpm_all_coefs)\n#print(logit_all_coefs)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# (LPM) for balanced sample\nfit_lpm_bal <- lm(reg_formula, data = data_bal)\ncl_vcov_bal <- cluster.vcov(fit_lpm_bal, data_bal$job_id)\nlpm_bal_coefs <- coeftest(fit_lpm_bal, vcov = cl_vcov_bal)\n\n# Logit Model for balanced sample\nfit_logit_bal <- glm(reg_formula, data = data_bal, family = binomial(link = \"logit\"))\ncl_vcov_logit_bal <- cluster.vcov(fit_logit_bal, data_bal$job_id)\nlogit_bal_coefs <- coeftest(fit_logit_bal, vcov = cl_vcov_logit_bal)\n\n#print(lpm_bal_coefs)\n#print(logit_bal_coefs)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nstargazer(fit_lpm_all, fit_logit_all, fit_lpm_bal, fit_logit_bal,\n          se = list(sqrt(diag(cl_vcov_all)),\n                    sqrt(diag(cl_vcov_logit_all)),\n                    sqrt(diag(cl_vcov_bal)),\n                    sqrt(diag(cl_vcov_logit_bal))),\n          #column.labels = c(\"LPM\", \"Logit\", \"LPM\", \"Logit\"),\n          dep.var.labels = \"Call Back Prob.\",\n          covariate.labels = c(\"Black\", \"Female\", \"Over 40\", \"Political club\",\n                               \"Academic club\", \"LGBTQ club\", \"Same-gender pronouns\",\n                               \"Gender-neutral pronouns\", \"Associate degree\",\n                               \"Wave 2\", \"Wave 3\", \"Wave 4\", \"Wave 5\",\n                               \"Midwest\", \"South\", \"West\"),\n         #omit = \"wave|region4\", \n        #omit.labels = c(\"Wave 1\", \"Northeast\"),\n          star.cutoffs = c(0.10, 0.05, 0.01),\n          notes = \"Clustered standard errors by Job ID\",\n          type = \"text\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n=======================================================================================================\n                                                      Dependent variable:                              \n                        -------------------------------------------------------------------------------\n                                                        Call Back Prob.                                \n                                    OLS              logistic               OLS              logistic  \n                                    (1)                 (2)                 (3)                 (4)    \n-------------------------------------------------------------------------------------------------------\nBlack                            -0.021***           -0.115***           -0.022***           -0.123*** \n                                  (0.002)             (0.009)             (0.002)             (0.011)  \n                                                                                                       \nFemale                            0.0002               0.001              -0.0002             -0.002   \n                                  (0.003)             (0.017)             (0.003)             (0.019)  \n                                                                                                       \nOver 40                          -0.006**            -0.033**             -0.005              -0.027   \n                                  (0.003)             (0.017)             (0.003)             (0.019)  \n                                                                                                       \nPolitical club                    -0.002              -0.010              -0.003              -0.017   \n                                  (0.007)             (0.041)             (0.008)             (0.046)  \n                                                                                                       \nAcademic club                      0.010               0.052               0.006               0.028   \n                                  (0.008)             (0.041)             (0.009)             (0.046)  \n                                                                                                       \nLGBTQ club                        -0.005              -0.029             -0.00004             -0.001   \n                                  (0.005)             (0.030)             (0.006)             (0.034)  \n                                                                                                       \nSame-gender pronouns              -0.014*             -0.077*             -0.013              -0.068   \n                                  (0.007)             (0.041)             (0.008)             (0.047)  \n                                                                                                       \nGender-neutral pronouns           -0.010              -0.057             -0.017**            -0.095**  \n                                  (0.008)             (0.042)             (0.009)             (0.048)  \n                                                                                                       \nAssociate degree                   0.001               0.007               0.003               0.014   \n                                  (0.003)             (0.017)             (0.003)             (0.019)  \n                                                                                                       \nWave 2                           0.054***            0.318***            0.051***            0.302***  \n                                  (0.011)             (0.063)             (0.012)             (0.069)  \n                                                                                                       \nWave 3                             0.010               0.062               0.017               0.102   \n                                  (0.010)             (0.065)             (0.011)             (0.072)  \n                                                                                                       \nWave 4                           0.039***            0.238***            0.042***            0.249***  \n                                  (0.010)             (0.064)             (0.012)             (0.071)  \n                                                                                                       \nWave 5                           0.151***            0.798***            0.162***            0.842***  \n                                  (0.011)             (0.061)             (0.013)             (0.067)  \n                                                                                                       \nMidwest                          0.063***            0.323***            0.045***            0.230***  \n                                  (0.012)             (0.062)             (0.014)             (0.069)  \n                                                                                                       \nSouth                            -0.030***           -0.170***           -0.040***           -0.221*** \n                                  (0.010)             (0.058)             (0.012)             (0.064)  \n                                                                                                       \nWest                             -0.027**            -0.153**            -0.039***           -0.216*** \n                                  (0.011)             (0.065)             (0.013)             (0.073)  \n                                                                                                       \nConstant                         0.207***            -1.358***           0.219***            -1.292*** \n                                  (0.011)             (0.067)             (0.013)             (0.073)  \n                                                                                                       \n-------------------------------------------------------------------------------------------------------\nObservations                      83,643              83,643              65,368              65,368   \nR2                                 0.024                                   0.024                       \nAdjusted R2                        0.024                                   0.024                       \nLog Likelihood                                      -45,164.010                             -35,644.270\nAkaike Inf. Crit.                                   90,362.010                              71,322.540 \nResidual Std. Error         0.422 (df = 83626)                      0.425 (df = 65351)                 \nF Statistic             126.977*** (df = 16; 83626)             101.025*** (df = 16; 65351)            \n=======================================================================================================\nNote:                                                                       *p<0.1; **p<0.05; ***p<0.01\n                                                                    Clustered standard errors by Job ID\n```\n\n\n:::\n:::\n\n\n\n# Figure: Callbacks by applicant first name\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- data\nols <- felm(cb ~ black + white - 1|0|0|job_id, data = df)\nols2 <- felm(cb ~ factor(firstname) - 1|0|0|job_id, data = df)\ncoef <- as.data.frame(summary(ols2)$coefficients)\ncoef <- coef %>% rownames_to_column(var='coef') %>%\n  extract(coef, \"firstname\", \"\\\\(firstname\\\\)([A-Za-z]+)\", remove=TRUE)\ncoef <- df %>% select(race,gender,firstname) %>% distinct %>%\n  right_join(coef, by='firstname') %>% arrange(race,gender,firstname) %>%\n  mutate(order=row_number())\ncoef[,1:3]<- lapply(coef[, 1:3], as.factor)\n\ncoef <- coef %>% mutate(\"Race and gender\"=case_when(\n      race == \"Black\" & gender == \"Female\" ~ \"Black, female\",\n      race == \"Black\" & gender == \"Male\" ~ \"Black, male\",\n      race == \"White\" & gender == \"Female\" ~ \"White, female\",\n      race == \"White\" & gender == \"Male\" ~ \"White, male\"))\n\nplot_A3 <- ggplot(data = coef, \n       aes(x = reorder(factor(firstname), order), y = Estimate, fill = `Race and gender`)) +\n  geom_bar(stat = 'identity', alpha = .3) + \n  theme_minimal() + \n  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) + \n  labs(\n    x = \"Applicant first name\",\n    y = \"Mean 30-day callback rate\",\n    fill = \"Race and gender\"\n  ) +\n  geom_segment(aes(x = 1, y = coef(ols)['black'], xend = 38, yend = coef(ols)['black']),\n               show.legend = FALSE, color = \"#F8766D\") +\n  geom_segment(aes(x = 39, y = coef(ols)['white'], xend = 76, yend = coef(ols)['white']),\n               show.legend = FALSE, color = \"#00BFCF\")\n\nprint(plot_A3, height = 5, width = 8)\n```\n\n::: {.cell-output-display}\n![](blog-6_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nThis figure shows mean contact rates by applicant first name, organized by race and gender group. The horizontal bars show race group mean contact rates. F-tests and p-values come from joint tests of the hypothesis that contact rates are equal across names separately by race and gender group.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nols2 <- felm(cb ~ factor(lastname) - 1 | 0 | 0 | job_id, data = df)\n\ncoef <- as.data.frame(summary(ols2)$coefficients)\ncoef <- coef %>% \n  rownames_to_column(var = 'coef') %>%\n  extract(coef, \"lastname\", \"\\\\(lastname\\\\)([A-Za-z]+)\", remove = TRUE)\n\ncoef <- df %>% \n  select(race, lastname) %>% \n  distinct() %>%\n  right_join(coef, by = \"lastname\") %>% \n  arrange(race, lastname) %>%\n  mutate(order = row_number())\n\nplot_A4 <- ggplot(data = coef, \n       aes(x = reorder(factor(lastname), order), y = Estimate, fill = factor(race))) +\n  geom_bar(stat = 'identity', alpha = .3) + \n  theme_minimal() + \n  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) + \n  labs(\n    x = \"Applicant last name\",\n    y = \"Mean 30-day callback rate\",\n    fill = \"Race\"\n  ) +\n  geom_segment(aes(x = 1, y = coef(ols)['black'], xend = 26, yend = coef(ols)['black']),\n               show.legend = FALSE, color = \"#F8766D\") +\n  geom_segment(aes(x = 27, y = coef(ols)['white'], xend = 52, yend = coef(ols)['white']),\n               show.legend = FALSE, color = \"#00BFCF\")\n\nprint(plot_A4, height = 5, width = 8)\n```\n\n::: {.cell-output-display}\n![](blog-6_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggsave(plot_A4, filename = \"output/plot_A4.png\", height = 5, width = 8)\n```\n:::\n\n\n\nThis figure shows mean contact rates by applicant last name, organized by race. The horizontal bars show race group mean contact rates. F-tests and p-values come from joint tests of the hypothesis that contact rates are equal across names separately by race.",
    "supporting": [
      "blog-6_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}